package com.jero.esc.common.utils.wechat.business;

import com.jero.esc.common.utils.random.FastRandom;
import com.jero.esc.common.utils.wechat.entity.closeorder.CloseOrderReq;
import com.jero.esc.common.utils.wechat.utils.Configure;
import com.jero.esc.common.utils.wechat.utils.HttpsRequest;
import com.jero.esc.common.utils.wechat.utils.Util;
import com.jero.esc.common.utils.wechat.utils.XmlParser;
import org.apache.commons.logging.Log;
import org.apache.commons.logging.LogFactory;

import java.util.Map;
import java.util.SortedMap;
import java.util.TreeMap;

/**
 * Created by fxy on 2016/12/28.
 */
public class CloseOrderBusiness {
    private final Log log = LogFactory.getLog(CloseOrderBusiness.class);

    public String sendPost(CloseOrderReq closeOrderReq) throws Exception{

        /*closeOrderReq.setOut_trade_no("0W1aNe5W1TjWv9FJmtn7CqH6YyIeetIM");

        //out_trade_no=0W1aNe5W1TjWv9FJmtn7CqH6YyIeetIM

        SortedMap<Object, Object> parameters = new TreeMap<Object, Object>();
        parameters= Util.beanToMap(closeOrderReq, true, parameters);

        //默认设置
        parameters.put("appid", Configure.getAppID());
        parameters.put("mch_id", Configure.getMchID());
        parameters.put("nonce_str", FastRandom.getRandom(32));

        //获取MD5签名
        String sign = Util.createSign(parameters);
        parameters.put("sign", sign);
        log.debug(parameters.toString());
        //将信息转成XML
        String requestXML = XmlParser.getXmlFromMap(parameters);
        log.debug(requestXML);

        String resXml= HttpsRequest.postData(Configure.CLOSEORDER, requestXML);
        Map map=XmlParser.getMapFromXml(resXml);
        log.debug(resXml);
        String res=(String) map.get("result_msg");
        log.debug(res);
        return resXml;*/
    	return null;
    }

}
